// Copyright (c) 2025-2026 Zack Puhl <github@xmit.xyz>. All rights reserved.
// Use of this source code is governed by the MIT license
// a copy of which can be found in the LICENSE_STDLIB file.
module sha3::shake_tests @test;

import sha3::tests_common;
import std::hash::sha3::shake;


// See: https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/sha3/shakebytetestvectors.zip
//
// We of course won't do extended validation here, just sample a few of the many.
fn void shake_known_vectors_long()
{
	test::eq(x"3109d9472ca436e805c6b3db2251a9bc", shake::xof(128, 16, x"a6fe00064257aa318b621c5eb311d32bb8004c2fa1a969d205d71762cc5d2e633907992629d1b69d9557ff6d5e8deb454ab00f6e497c89a4fea09e257a6fa2074bd818ceb5981b3e3faefd6e720f2d1edd9c5e4a5c51e5009abf636ed5bca53fe159c8287014a1bd904f5c8a7501625f79ac81eb618f478ce21cae6664acffb30572f059e1ad0fc2912264e8f1ca52af26c8bf78e09d75f3dd9fc734afa8770abe0bd78c90cc2ff448105fb16dd2c5b7edd8611a62e537db9331f5023e16d6ec150cc6e706d7c7fcbfff930c7281831fd5c4aff86ece57ed0db882f59a5fe403105d0592ca38a081fed84922873f538ee774f13b8cc09bd0521db4374aec69f4bae6dcb66455822c0b84c91a3474ffac2ad06f0a4423cd2c6a49d4f0d6242d6a1890937b5d9835a5f0ea5b1d01884d22a6c1718e1f60b3ab5e232947c76ef70b344171083c688093b5f1475377e3069863"));
	test::eq(x"8d0e0d0483e0f5a761eabec6a7a8f455", shake::xof(128, 16, x"a285a84702f9cd932e8b18f774a065afb4e8b38914417ee9f4d9491125937a9f55ad6a57ce9fbd236146ef589c41303b449c72c4ffabc0a25039d17ec8e3dd847bbeaf20b240fc05df5df374d6f015bb395d47fc3474252f6b999a6a3122ad60fb019e2914a3324192184bd28873bb367d745ab71d64579a2f41cb5dc71b943cbdbe60fa5d9108dd60be20fb1c93ccb4f729d4802143fbeb83788dddf295381fa93d1c1bf6d225e333999975f818ed3e8fc3dddca8d8bc284e8808741a574111a7c5fb15452e335af2efdfca86cac8da2d8c9c551aec3f5b7ab763a9a72a581b9f9f256eb46dd74b850919812c710593b9ca3a72e0472f8bee4ec70401d625437914c1b1aa56bbbdd32f702354d44c6e1bc6dfbb60b132c192945b0e91234f931d6af8638fb287b8c6a80c3765bc43753cc8b1b903f2f0044ed3484ebdd97f1373e9f10eca49e34545be1445c7f195af0217dbf331d1135c0a51b54deebf5cca64dbd539c5e3756a39b7b0d6e13be82456fd83f2531840d1ae58cb918d9e8fc0d686cb6de748e83188dc0a711d62e5dd21c0d23ccf8d216c222eb1a4003ebffdb234fc31983fe2a21b75479ee22d33e149a9ef5b0ff95e344e1b900eb167958ae12b8f0d40920bc4daca92e599657a38b80002d779239f321b69905506e1b86e4ab3ad8947070d9fad2211cfa8d264eb540d353677d58b6c6f5ed8036973d2b1d4167e2e16678d3b7dc7ece3783c97010717ae0270d5caec3444919f41e7885c699a2983137936a130ff4ca9716bbb82b76895c2ccec05ba5061e2b2f6038475f089d711a707add8b01359aafb2779774e4613fff2e2e4dcadfef4c3f0906e075029af5e3ad79de8e34b3a6d7f3779e7b3fa50404c7f0e5c3162ef5a9655ed1773c3daf435b3acdab3ee187b636462dacecc730d418b2c41c6d7fa00521caaaf409e7f5bfe6182b507461a5a1176dc588703a4ee39cde59453a33d3b8bab4dd69f04c719ffa9c881c6996994ef35916ac6e90d6c9c0ee25cbf0fe196aacb7d95783bdab89f552646da302cb16768261773c4d30ed316caa1f4630e961544e2f3b38cdfc0452b430d2a538c37e0d9466876dd215d44ad466cd9e7ebc535de25f8393ffeb75bf5c8dd9e49b1b0c24e9763b77c1de0589bfec456e3a1aa7261eeacf09c612748795cbf1e5cc2a37490c1121fe9ef1f77a799b1539e57cd3594e418c1eb2d977480a8ba92d2e79960676d7d946bc0a20a9bc03bb86136b7e440b04394738d9047d154d6e2f44a19ed9a43abff4bb8f2773d1a6b6d7466efe92dfa35527da7992936071bf70a10ab83f3eaa449d2fe96285650485b1f0efdaa2369f7e151a33a82756992b75c64d78a380b705845bb1683ad09da68aa576a91eaa5902b37aafbba5723420b316c266a324d1816ef16fbf2"));
	test::eq(x"e3a3c929d0ab5ff911d9d30a690837a9", shake::xof(128, 16, x"190970ca7bd95d2b26b37ef95f58de291e71d4c512802884e417779ec048d9de125cc0f98dc7241e725cddce0fbe50ee86174d1bcf0c383d00f0675fcc37ccbe4a2ed41ff8ea8e66007e1065ba7217f27170ed3c6a3f905f22f61035d869396f4be872e5c529e52b5882e065685b7b5c6ae47cd1ea037711d3913ac9ebc5681c9df063f3fb6b6f9403ce15772163c654f6dbc181583f377b9a29acc30d33a0ebc6b06ff0a29a76ca88cc7742ee713e049fbd85f5bbdb16c6ff262fca469b2a04508e5d85c39d40f56fe3cd6fd66e2d92ecf290d41bbe5d1a8af08b869fe54e90c3f4f759655c153b417ae1a5e240d92665e2aac781d2539ec4ef88a01ffa54b7a549031590bf3fc785fb798d19d08be993f59b76f3fe427b348bedc0cfc084a080f54a604cae05bfc3cd5ece83068a02fd942a887c2a70d8632d848db5202674db6094e3a211ae4c8458581128ca209a2c2521a6213e26ded73b13b0db02815a3ff2a94599d083954e042ffe110593d9a6124677ec23acb51a1f63d0494fde7b3313502f3ad3ccc3ac39aa3c459d2ce6f5c162a4e4bf4a84b43f3c9606ed85ff3f2b53498c02d1fd235f9274cc7c33eaa09c3cd411fb48732b0566aa1ac6be0deba2783a9746d96c3ddeaf4daf88f00c30099eb07cc0edac09d8a8b38dc1d1cdc0e088ab63852d37811ec970f5abaa752c724edf2cf48354d51fcb5a67c50568454d4a43f9a916887788a884a6ccab4c1c3e150a2980509618449846b1bca406035188ab6098da84a8821332cbd339ba89d5bbd97c4d9d9859aed41f738df4ce8055088aa03cc1559b75d4226aa79de7fa9f08f32c42b18220c54a8fb3203ee946bf9389c27b1523d8cab1fb8e321ffaf704c4014146d67df6f1c13c7b5dc97fddf9f150cc3f1c15e8e773663c5b061c086cb6aac44352b1619a00ced22cdfb7cb69ea86c96f20545236e20a7e0a9c74b63fa797bc206e45eb28d0eec175c6b99a7946d3bef367079e1dc5905b27272b88e55f7031c572611c03f9444e20c7aed190cce1b5b339575506e59fdc9bf06807c6a6dc2c1aa62f7b93437784152abef9154555b596e06cfe580be0074c3f54b94a4483b30651d490417630683c371099727adac786a36d217bfdfae6235c1728da000ed174bd7be3735916047d36cd390e3016f26bc98347d7849681088ed8dcdca3258b49304afd92b5d25fc16e1c625132b13e2b9bd5f7d4675cdee41ebf5cbaf56feb6ef3696507520b81ee28269aa34754b3af618cb9da70f3079d54f530dabe95f8cb4e01a339f86a73eeac126c6c36a75adf63cf15516504041d78a2e0a6c63eba48883a408f6f963ca742095d14c8513aa3e8c794a10f36db4ad2edf484d5133aceeb3bc3737e38e4033233f703c5fb5be43a9bbd323632960eaafff5deb2bc7f43bd2db44ceff874e9c3b7c1a2f54cc6889f74186ca2a03d5047006b1b26e0919147379c81887df3403ebe43571fed8279607a2eb81a26d6f8f217dca3f927799ed182017c127069f2eb6f068b0d85979dc4d4867c676f6bedf36cd2def33b3e54a3366ea45478dee612f391a785bd0ede15aba921512103199228d434dbc1e899047a6861183e5b04fb716c11503dee2399261d10a0e5a76317736b0d7b6480573e76791b246ae734ee12203336ac3f539a6e6cb01c625eb3c9741dd199ca0d759753283a41a38b5e32fe3474feb20a585eaa1d688d4130f1f15475e8fe9b97db5839fd2637914e6a105c303b72f856192e03b9a2ba292505d73af8ba72802771c84f8148cedd3840d0549df258262b7e51a1c7c56cc346d8c34f30afbd20c31f31be3b06ce2f51c9ba10020079e4916f11abcf396bb79a50fdbba430a62576cdd9adb4c9fe2ea2eb15b5e7cd9dd891d4b44a5a657fac2956cca5dca3f6344563094572fa2783328f2b6ed4c18bad329583a5efb3704afcd37a35617275f83ac909aeffff11d6099e426152440d097d9bc6e5168a053a1aad4d95ba03eb165ce7210fe34284ce30fea3b6e8bee99578ccc531575207248bce8eea6fc02039b3a59990a4294813ae9996961f97e8f82d11c7b23b743faf581c845f0910dc0748ecb85bcc1e244e8b5562297e37d2daa453168f49567284888179190f5ae62822a2c895e388e227d01c51968d066fe5e478f8f10a616b4b23e4b3430908074549b10f696fcf484584d5a906d46d87bff569b60004fdf1ab322c7b037f810706c6ffd6fdfa5a1f51af68b3a0dcd2e110df0f97e3c193cb4cbc431981fa2dae12a07664790b932ef259bcb78d2c9e4681aa51e5c3c989c2d7c910d5e70274c312dffd03062be13fd18bbbfdf44c3a7eb95f16e6c7a2499ef4627bf75a1dbe10ad8c7bf9cce0ac18954d4cccfec50c51610648e418d639274a8d6cc604d5735b8caeda8ff2b55d82e7a5576ed21e7e8721a5ce25ddedc3248254cb8b0db1fb6d564d010da02f5a456f9dc5299adff7e7a04690f23f6d4e5f43bf808f9d39be0eb471d8bb00d80c29d43c7c467b91df3a87f0769266e0419e36d57417daf625054e2347e03737dbf6bf8a650c9fbb9d487dac684f79cd06aa039e8d6eef6f961ccb6a36c670d43073d79068c52ee59bd92b814e6fa1bd044b5122b4db022c7a19d44f8db3d1387169c5556eb74f9740b53977103b0537a348c86ad2a53cb63ac510d934f082ea08a130e15d2c2b5af4a34e9696fbcec34b6b117dcd15c4943ce8281013c5ac725be0c13d1f6aeab51f6d12e7c8f723e9647ad4638f73c34eea4ac3fc13797759d4f120709ab9b33129d92f718f762d32563eb825fe07606dabb28aa61a560a26d99bf482b863ae547bb04a3cd1c213258a7f66ca0418c478e6ea241511a28e61d4a5e57c5faf05a97bb90e517821fe4b6605865a88ef16f705b83b51e1a62a932cd89d6579e4ddb592be20b76adc162a5397bfde71d57f736fe5746370aa074349fcc145ed4b610228852b76913a824cbaffb95ca91027738c397952a8f64cf993d9fc25a32cb617a6d8d597d3856b3901031ddf17e8357fc47bf22670d1223d7236f30c83cf077c727dc6211a03f877926c936ca3a7d11f7f7586e8af85b1984edc5102757b7abaf63ca71c4dfe5290d301c20d359325dc25edde9f4f5820918f94bc0f6179375899df209154bca00c2e8c53c9b5f6563d1eaca253379398b19d24dc3c2f1267dec22cd88717860b710ad3eda90b168fcbd27a790c4f7d407ee0545b90c78b32d4dbed78067da3bb49cea039b3203cf60caa1e0bd37f604182c1eede14112fbfc34be8a716705dd71be4b9dff1daafb38a0c6201afaf82c245a6b810cef64537337ae60ec0d8fa8870b3e6866b22b9efcd610c03a9c72dec4ef87c96c85c14c1aad0ae550b9bc3f5cfa3f1d628e1a0d25b12e5b8c8afa7e72520001b0a2de586b2b50a2300a20047c01ca07930fdad83be85b5c9145038da52840d459a4f00aed291c020a5d5f9a5cb86bd148b60282b7e2444dd95902aed5d8e6abc82acad6093cc99f5041cf53879490e5242f059f12156599d5458c34acfa5e129ca2a34c47bce5d4a25603e2751cd5cd85b9787fe3182beb158914d163030383478b3dc0314ffd4c60e871a9bdc7b6e51e13bfc79361239c0a9210e7c06993884962eef45e6c8c512c97bd2bca0b90e63d9c6fe8bb66d937250f24fa2db47a9c22b82b3b1778ffad65e22adb127f002b64d1fd65c3bfb947154ea57b036a253954099717052bd39b9d366f5a3f98913f3442ecc134c240362bdf370cfa012fda6dc5a70a9fcbb4b63322ef0b99cea09c2c7db27d97250a9f094f4e027a0ff719d07adfa85fef0f87d8361e81c9a7daccadd0e31d533e74fc1e0d4f0dfbed17521c97a552ce1c307afcce923f37ba9c4b48eaf30301a51bb7da97de81f82f0d2da2ba9cac52d9e42a017adea67c5d51827e2a66d11acf6b6cdf7d6101175c550713423a17968e86ff96b9584a0026b71cce2db30a1733f0759d3c7afda1eb6b68eedce226f1c085761d1893bc5b9d2974b9537c107f69278c844380fa5052cced85c9395d0d068c2814f7155ff7372524b04a0676cbd58cfc253117698b3905ef88b5b41c30d6f7801f0351b75b7b36a7435ff6bf851fad5f1073a2ddbaf482f95820c6f715a854088b9bed5500dfda670323d15d239de52fa689c7c9781be0958488f67013f12e3beb4f2cbb7fdb8cfe40340ad23fd6e0e887e1daaf4b258b3e9e4cd719c447e2a4ce8ba44d3104cad7baef27b122611d04152a60119c980f7ef61add56af232dada5dff8acbcd2108db3d3ac7c83b2e61cdeb20c72f4e9d9b13c416da92d094be0f1ca7e3c8bd9fa8acb7ffd86dc42f8ad55171455dca1668fc17f2c93d670d9d942c9b98f2662f5597252bf728497b11018d83c3ccc45526526228ea923d063e1095c4f0705237d6438ea56c21537abef8a63c89a3c4c19dbfaba085badce56a2c6009356b0921f45afa557f8169945b63a486de0b52c294e9fc42e2dccc13e9909451ad0a11537781722378701431aee990480c2cf7c0d5785cf6492193f983e33986a276f4372762fcf79e15dbb98133716a592d3a232615d4a401b1bbfe00ce588f5ad63a33cba5a3b93a9946949ae84fd30e37a45450686a3453b3cc8927f8f7541e5369b12df26c519423dd2ac1b1326d7271bcb91b18288e874f4c04c10a21bd35150b1813ef61a7f4dc29e4c036231fcf040abb4ece169ae5afc5d696abdbb2e943a7d0464789a4a2ecb1285e1e29d16b1716c2b3313b41b4f8be676e842f1b8006c6418ea0ec2ee57afd5f62124d6b90d3693710ea9f693e55c01f113c24e04385efd3b2a3932e07ae96f295b996d684608a802ea04afbc9ec5266477cc2e97ae9aaee7cf7858d4eb10347bfbc0cf88fe50107d5fc45e09ee5fca4d7ec121e6d597ffab244ca3103abccc8a8c2b7bafb8a5733cca597fe056946418a331b6863fef75f1d346b046dc37adc1774a0040e79136bdd44483f45a0b9a528fae6ada6ff9985856d6fedd62294ead57acebf12d7bd19ce81618aa8b1dc3879e879d77c85eed4b297ded384f0a25cab7b49d14dcfdda46803e8c674c4376344a6decc2eb87db56b5bc1a0c0542d995e1f1a240886fc747373e8ddf203538c53db1d7603bfce8e79611f3bd276bc09b90f489f8a27a1f1b77866b66a94b71d6c303cbb45c369c8a550008c027fd71483f3db291dd85583fcbb6c39249feb7c584d45853aebd7ccb5d06c7b989706228372dcac07c19f9209e4014e674d7813dfd93fbb2c609f01718b6cf0dbe5d29b8235520f910c0786a79a2edd7dc5e548c87d3345614949cea32607d31492c2e748e4453a03de15c79e85faceac30ba85dde0280b22cf5d9d114c460c8cc55f6e9d26bd14a56252bdb64e6d093db68031e4ab26f4b61a64d584a32f8388a72f9949a3c387bebd45d0b69d8f77787ebeb3a68536ea6751e6ddc4d3cd215360bcce13045e7b981a7769681969fea4b1fc75eb175ed57b9d691f998525cc34178e76c5f197d6799f6eee926b02870a76c3de7a08a89b3b257702cb61416d72f52bfa25117581aa74b4c9fd3b62fbf3f699561d011c25ef1297ee210e28ed56211dc0fc0d006473c2d16071309240a55909459aaac15bdf8b524b6535e23228c3ec32118c40671bb14b1db6f2994069c69813baaa9f2552b92e825d7d782630051eb72e373e73ec68ac67932a7fe18665d02945aabe6c92c3b5f9d28ff1b0b50d3db619b6016e2c107ba5d1804d0d465f38ed03512716e5d26f198b1255b70103d1999bb0914224d04141389b0aabefdc58c8bc48e10d940ee34a52afac255a1060c77ccef7d51cd185a29024bea3ca03b9233736f437e69e99f5ed0effe1095c74a884b73a115c3acf30a1c271dd1ffde2643dc4697e25ab198025d655d3550e94a47b1362dc2b34a853331e2c4036f25bf5969a47c9975cec55c2afb7e3884e4923288c7820d3e796730ddff6b65609ad3c0a5f96ff86da99da8c432cf9e946198d54c882c49a7a23f8f8aed827c86a5fa361bb5e0a384ca8794b37bcfdbf1b8f4ac76f8bb0c916d74abc33d979d53ef9906258a8d1f6dba199c6366fd753f830c2492a98cca7e239d121150195c3ad046dd6db7b3c07af0da1c6e64e6fed03865ea2a1b3007e07d1f6effd5863dade07a185efe033b5ef74fb13ef60add4641884997be33494ac271fed92e7cb64fa8a94373ade9e46c45c0e75faae7a52446e9df860315033fac4b6e47db5b6a72815aeb4647d6503554f42b4af3ebcadcb111285faa33ca1192f219c65ca0aec913157c316c57134cbd4ff97b51a5d2e20884909ee44e02630f0caddf32fb17b5c65f72ef8bfa8214d74ade7b54a431d6c5bac4be719240c6790176fcfeb919cb23af6bbb172f31104b5b46c56d458c2d613a2158b2cf199e7967219a0069497bb37bc33eae73b4e17227dee41c282648737922d82842d17d88a42a40e89a1b39ee4b15d4a24661eaf406e351d1cab4da64fe65c7529c2cc62f5eed9c37b9f3a84c93e037a335dcaf499f00893e8bac35ce3056a0c249601ab5de07d64e47872946fc9eb211c09990db46c314b30970fd17c571fee7c93fdde4d7f5b9ccd13a4f75dbcdee8e551d523194876ecfb2a792ca14443c439a00a214a333a103d5817d41b7da477981cc45d51eea01f525b4896db349d3564a46e9cde64e16b3c2f1554327605753c54b0e4e3c4778b3c12c636b18ff6ea03897279907a1953d280e49f290dc98adae0dfdf5734c2d9c1373935abbd168a21365edde8ddaa700833cddc88acb75f79a89a7736a44bb0e9b2eaba5126c5bec3937af26ff65c6ce5301834d8ba999c219428d4067ed8b9bd6b21ee2c33cb2ef3880de0ac2bf7ec715f0dce9f9f35e9da8cd31d5229329b444a26f8c34aef81b8fd61cf28e5429bb5a9f4d368c253ecad78e17b9f0d21ff863840019ed5fa601bdabce6698d061eb8f4146ab88dbd50a1409b1577926c8d8c1bb831463ab5722207674df9890b20832ab6bc19673abbbfcc49146120ddec5dddd6af42e3e560d76caa2d604319471c3122f012b891d60e04339fe61f3ac50164e2a41a3655d142f2ccae2421f83b8df3a02f2ce98b4896d1a0df8cf74cbf819a2437579dcc6e6a7f17f7cf8d6fa5de5678a1ed60f0b95f19dafbde10db83e465e491807f11df57fcd131e9ee482d1544f16ddf8688d372c6271c61d3afb832af69d91d43edcb11524383f8ac497a3ca454bc8ac31a3bd6bed06a9fa68f07745ffc38b75328daa167b516862f3b355a5de9b57580709c93eb1c0c1ff24418b15de5d6d5168ab50e256f111adee5057859f8812823509cb233552b69209792f1916cdafff4db046073"));

	test::eq(x"2bac5716803a9cda8f9e84365ab0a681327b5ba34fdedfb1c12e6e807f45284b", shake::xof(256, 32, x"dc5a100fa16df1583c79722a0d72833d3bf22c109b8889dbd35213c6bfce205813edae3242695cfd9f59b9a1c203c1b72ef1a5423147cb990b5316a85266675894e2644c3f9578cebe451a09e58c53788fe77a9e850943f8a275f830354b0593a762bac55e984db3e0661eca3cb83f67a6fb348e6177f7dee2df40c4322602f094953905681be3954fe44c4c902c8f6bba565a788b38f13411ba76ce0f9f6756a2a2687424c5435a51e62df7a8934b6e141f74c6ccf539e3782d22b5955d3baf1ab2cf7b5c3f74ec2f9447344e937957fd7f0bdfec56d5d25f61cde18c0986e244ecf780d6307e313117256948d4230ebb9ea62bb302cfe80d7dfebabc4a51d7687967ed5b416a139e974c005fff507a96"));
	test::eq(x"01687fe6caaf222afc3351ea3027e68aa1c5ea015689726610125bf9ff6ab4dc", shake::xof(256, 32, x"5cf4123ca07cbdb02586138f23faae1d9e5d4c2ee847753b67175eb598e50e9954b8bf4553f9878aee28370229ce84a4f0b36495a150bb41cb8737ab36927801233a7574d4491b474f413725604e95b7dd7a69762d20efbe0ba34f24885fc30a4fe0fb712d52c10ed139d99fd0632b7fec1a2478959e59d9b0d26dc9983535db62141be366fec007fa79e61981f38c24a5fb5a44e0b140bb417b5b426dfa189de43d9b728534625b5567253a7ce701cd9085d6821643ee8c4608df360f98b2775bc244c794dced32676c60abc828d2a236215fd9403ba97348e0c24e87f54c92510dde8a9addaab3baf15d136d9d47cc1e35bcf16580ba98ce6bcb31dcfb2d164d853163a021e107d55ce51b742da873d02bb6738dfc69246011c48716909f2ad89204f8ad8fda554016c06be4c23cbed5691507c096fd3f863a73fa3e9ee8f6799c21f4c90fdcc68488b6aac5434cd6b459a1540736c010c94ea2305a0c51a3b80b4efdfc89308228198f801f9720e3f561210369c4f8c0b0b517d175c222591d4854bb4fe51fb0b4301297fba8000c21eb5fbbef29ee76c4d79b8694a8a33f31b9fbd8c90bef79b0370994605d3479bf5e2125a04bea5b8b1df5f7c1a61c7e7bc70af973e4e804a5953a22579e0353572230e9841333978fedefcb03a4d43d83da4bc85356547a1bb26de7e753b7c2719f54aea369135158b04faa638a14a5d25b84ed744a790298f66c8b186496ed963d541c0636d0b26ccfde3ee74024deefb07e10dba9a1c5a6c9feb7f2bae9fd4d64fadcb460b3e155b0642c99ae4c0f624301d8925912eacc93ea137e3bf7191f7c0c96b5d104069bbda91f81bdd461b47bd5eda044149a93bcf946c3d00a6a93ed53f1126f0b4bc45d74bda65303fb6cbfc1f80d50f1fd81acf3f9c9626818311f9796d22410d65af78eae1059220512798ea1e167ef3a20cba0d399d75a4a817aa02dfdd75acfe5f5c09bc7b879a92f10048f2570587af882c77d3a1928280c67355d9c70325febbed02cd456500d4aeceb6be15372e48f37329eb40e1adb594c20ceb5d6e0aef6ba86083e1def59eb750bdc1bf886a16f53a7df10a0788bf092272953f3ace38d51acd80df49db69a132c8bdd47dbd8203fefe855b6895f5aa213167baedd2639eb084349c2a44ce02e151f2e28bbb22862d2608b3796801ee2ab3c37efbda180f064f2fb714a42442e8f4117836c57112317efbb0de716c4bcb9448e9e9279edc8868c2be8d8c04f7b62999e4037ee63ec883eec1fc448d59703d589a4a5d905db36badf0f95f0877d56cece47649fa424ebf52655753ed8db53982ee73ee752923e2421cecbf8769c3289ac803b945e3209bc7197412155ef6f358750a5cb5b536571f80dc000a441c07142d304f21880aa39d6cd7219d43d1f539cc721aea887724a6db4be3198d2c62f972906e45b7595175cdf4e4dde2c2d9a7335fbb8c2972e5686ab0bb2dab90d6ab3688a90ae7994fc0cb51ee6fa245fb416807c1030e9613e4ddaefacf25c5dcb9f7ad81e99f46d91ec38290bb18d7f468d92e9df7ae7d2a9ca2ab44769257efa624538b7a44ee97d074eb9e58ad053fbde518d4c29f84b400481a0aac57b379e04b3f28358f0d06862e0149c0d53a47813a7af80c48392ab03c9fdfe91c5515f8eab4da93c40eafc07d78357c27f3968347b96a2d3f27191cfe8116a526d95e707149251d9a7ffdefd194e3e32bcdc7147b48bdbdeacad9a71c8251792dac8db77d80aa5b58ed6b94c90bd7ae473533b563cd6536e19116ff04f802dd874b5e6e6defaca5a5b3833fd221833600a676f68fabf310aa164b854676cd3ada323ae5d0eadeb5078edf416b9a6902febe0b586d68e9e3bac6d1ca5f72f3198cfd9dbe3506a2e1d4bbda5a23cb0bad87c86b4b7b88ac188a2f544ece612702160a016818c78bb4b3e70eea6937ed9e32721150388fcc379ebc4d8311e5db8d0be40073eaa20bb62b7cd762ca65814d953787f722e2ccb96efa27f7a8658302e5181552292aa56e8209de63b5d86934167549b0d936202681757e1d1064b01c2822ba8352d5eb367e0a8e5dca04f7fa3cd7d11db9de68f76c9aaa73d867d5214b705aa806183fb665fb61c1657fd0087ecbb88e435ff9b486e6579c7ee374cad59d8010a1763556e058f33f16ad63d762cd6a93144f74e676f4efe7526c11714d16c55db3844ea063afad175c1235ff8f5951bc9b014cf5a322edf511763dad186894ffcaa6fe2b666c19eab442b8d93afc186b5639f47a921ccc463a765be6ddff79674572c6406f1aa449adc38f0d1c22294fb43dfdddda3f253b2bf0eea6f467dd34b25c3987f437e684a6f90b0399780eba53a1eba7d1f66374648a7865f22e5ae8afe7ba7a8c404b5c4e67cf45394a333ba2fa20511fff116272878bcc6daf5ce38c99db909dd06d00f2a44e4a82253154309b5e722aa5b995e49c9b22bd876dc5d6e71f52bf44a64332230a9bfaa573847b29d8837886c67f191e29016832f7f02d43f8495739a1739b5886b20927846ce11a20fd801ec29ebea0a7f0f43ea602de54f8ecfc0bc9128cd935154437ee4e10e0ea58d7da286513b8ba79f806d27e988e83a6245787b08519a84e22631bc86912771df6457272d6cab2f4da2817b3ba554b0d568987de228e52c52a25876c782379c551ed3b386"));
	test::eq(x"b54b7e4d7888a484e8ee74ebe06e05369f204200181d15a7b7219aa0f1f2e57d", shake::xof(256, 32, x"e3ed1f4a7232bd65821ee185c5b05cc240e70138f1d664b8b6fbe1be6acde0a351945814b67d92c3d2ee305cf0176dbbcfcaa65c488c1a1330eceefd801374b6b39daccc70a70b7469297c7c8387a58137626b6238b4b8f4561c7bf8a276f14ad3af245be8d7b1e00f78cdccc6278a7c405857320a77c6c5ee349397181ee1c67773c6a766360a708c832c340020a615b15472b506fccdedc1db3bc22932cb9468909c9932eca08aa7f1a09c7b9981b254fdc5d1736c55d497ba7d611eda381b6eafae199320fb98296b32ec7dbba1bdeffc576f9beee4e23878605c3f40afc350780210d3fba100db98e90c4fad909c4bf83178c4ab047f6bbeec9bd489b8f4d892a26438a41c2c8221cde53998d6b9309a59d237ca3c13f9342a0625e0db16cca696ff0b43f482e9ade65d82a4f97a668ad9673c741406ab8121867a6ba191f55be4c79302af6cd7e53d5d74f88349b46fb91d1ad115c0474eda011a5291ce1b5a96a61a07d7501370d9ce55bdfc8de3f2ffde1b08c6aa95425b604ebe3433064bb483e67af39866f8c2966e1aeaadbbbab5918542b02a5f06ae8c5ed710297dd4444540848cab9822019f0738d7130470e21ea1a659a96b41db6c92c4af194aa050d6704d29f171989dcf683f4a2686bb8f6cb75d4b90829ce8e731ae99693355df1dbefc52d2b9029e10d856cc4e0944c3650f8e0e456cbfdfe785bc5483019cfa0272b990b637070d49a1a5e4f354b286f0f0622832f151c753d4176acd7c1ca86dd3ae6905b450f16209551a7d30aee0f5a40123bdd9fba91267e663b16b7ef1462a006727f8855242598ef65565e0da5d71928750eb648c0e8652c5959769dd75bfda1285cb4d38d3d87701e1bbef7b0ea03dda52f034782e79831ae3c98675e3da62f185f550acfcd039c28afa84ccf1782ca62bb115765a87a0e902c77dc076c3c08c903d37b5a587fbc1b8e946d3ee43847242f3ad8c7af9d1bb5a59f5c617c11d6b0f6caa5cb646e687d451de9aee4770c70181a4c57717401753499690af1ea117684a50a81855229b44faf329d7ce162ccf22a32637291285555e092524207317059fd2a1b1fcd68572ac2e86931e9e29149d52b9a377728dc85ff68e6010bcf34c33d74f6a832bcec42f37bb087f314639bb5885a34986b8141504d14936a334a7ce08bb2c3148fda44ab5d0203bf70ca4445e9220e6768da148dcf8c9d951617d370decdd50559a79c750cbc1991702be000be900976b95d8bf260ac742ed0235378dea66267c2eab6cb1b6d5e0b9b1efb608912da48d561f4489102abaa09f399631beb0fce340a20280984359079fa030fc928d55035adf9dad11dc8792c1f01ca06fa219b258c550647af34c2656373490f50af1f62981933b15c4f1eaefc290820523c712fe7e200663cd00415e1e8b6cc18bc28d496beedb25ca42d1b217bc81891d4c2bbb35380e5bb9bf7e3dbbfd37fef70ef14407763447d6c06e915766430277f124165061236b9fcf057d785199b4381e49a2bcf3ef85d0b5ea14ea57707819fe25983863ed996779ffa5bc513cec353abee9f12cb3e7a0676cc33957b1f3ebbb58c7550616eff905943eeec3c5aed6aa78a310ea29742f1f1d27aa2eae7cd46fe32e0f1243753dbbebcf7870df0003b59e5780f5f934632424c7a6a30e1abf64ee52cf4e1e321ce32de0c12030eca4a4588ea915ca2f25c0aa2b967f79d691e0a2bdfb834f2e7cc481fa319a6079a1bfd0cff312446e5e39d7dce08a99b7332c26f6fd797e7147a710a430a818afe24e2ba2c6b310f8f4d8d261ee8c13c58d90a3853bf8520463d40266261000975099948f8ac1d6d5d1e5c442264d9208875341f31fc873eeba937ec87b9bbf38d1e8311fa7053d0edba8d408f294bc890abf27c60fb08a37322cac539711fe9b4e822ad98544eeaafc682b3ab92b394ffc1a7e89757a3fe8b5e6b58ee33a64c6b0b0a8468c4991b11b6ff060e2d8b26247ad6dc1b8ec39072a0bc101c5de9ac3ddbad3ec25dbcd2c1f034c03d764cfcbd1c01df840cf219f78e1f735a6c4479abfe8d255b6c14a22f26d67aaff973791849bb6b575ea9eb589b180b1efb514513d81ce09a9c4b19b7bf568ddc23893bc46855f81bf07595344c284fd0679a8f23ecfee8e64acaa9fa2e2782488118a5501c840e386ecf980915e2aa255d8ad84ac185b6e5141dc374f7ebe08b9e8c5629caa82633262274558cb9a27429ac8106ea53c31d64af06a6a0f6310bd86ebeeff744d892b318ba98152fd143786a39d6cbeba5d5d918d41dbde8ec5fdb3a5fe126dc8ded921ccb4f53b7bf29b65e6338eabfd7c4ddc5cc28a3368addf369b9cbddf1ce9a5fa936e9ace3b48d6ff39dabcb32c150ef405f760561952ccd974cfe8107032f58387e05953669e501c429bde1f6fb108a12fe8438ec83c2d62d9a07b49ed42328551111b11237d7084ac7ddc37f0d7a3aa829c1c249df1689a71155ed2bba0c5c99809c6519b6ba0fe1d899e43d40f47d9a81bd460c1fbe749e53979f301d4141405d1435bf5f248543dc60c8b46e25cf4466d518a5ce21037dc11b4f4e867893140707b775a9ace4cb63c0f576cd64ac4079b7dea952c4d2bffa7f81c97e08be6f0ee55edf2ea9baf2df38dee6e75791190ab3fc8956305eff6022bb536c781fdbd54b804e46a17444df46f99754751a38ca87e6b840e9f49682a3705efa5d53c51a98e0559a2aad5bb469ea0a9d33b41a197241c89b68502fd280255e801ee6c51f5be38781bbd2822f1014b31a19db577821823cce21ee25e0376ec49633455684030e56a5cb60728fe7fe13539e0c5b77042c8761ad2b033c37a143b530fbe3c93cc5456edff38757402acdf246d3a096a8a53afe709362371f513e65ae77075f57acd6557fe83b25b71f255e9abdb1477d80b9ecf2b3ad713d13271ff2434bc6f2297bf211db287bbb3fcbf100172819f14396c5ca085f7b4f5b904cb2ed0b908acfb8bd3c38b9b9db2124621d9c5f7ea26254016d1df2a5949f0c9456e0c13c80041f2f657d89708557c12a59a9e1f61f6174384240f180cb51ee5f54ab272b706b11b11435f220584814a24abc3a10b6d579d2e02df6ad4218d83632b8880dea7922eaceee9e59b276a162476fc24f1712c759cd415c8ba7583c9187a58e244c92e554fc03d88d2277f9f2f62135019ebe0f357007ad9c49949df9b9de843f155cbb6832125b2b26a080dccd7cecf8dc4b941e6f0d646fc7527ee74fe0049ee34b279cf79670b44d94d88843df74655e20084d10af1b66af2641e2c036a9c424c2bc7bc30cc3c8f5c9637ddfd5460772ffce7a1b892d215f64a964a16ede5f5877dc8d1ae1ced9bdc2a42617daec3fd92f78fdd618342056a1f7f569e50cc10ccf2a3965c1fc5713f52d29826cc17eef237a70d6c8aad42372c00d8035cf89a02d08193a09c6d186f560f0960780553390555b94370bcd543b94259acd9129b13608951e35d8d98527e203c947834334ea9c16a4dfc16c5780e6d61038fc11ce6eae4578e28ccfad2112db928954e96196b15a7f2f8631abd72a8766f45ae2363b6b92d07c6d245d65960098697f885829376f99a2a4ddcf92f1b2258c581bb720b315cb8ff4881459cdfb31446dc0671680ee7ad5c7a14168befec26d5e1e9fb33746b079ad6b70923d23f3c6aa224ce3305f9935492cafbcf4c5c423e76b7e674a9e25e6123ee0936623565caf2e4813c83b7b5db3e04904259fb12c7e92c1b17f84a241ad82e2d1db61ef62f725072cbafaa79b826ccbd2e3f50ff3ae25083638a29c18e9c7f5d1ff8825961cd6f8a28b15948b5f1296ad925e4725e082c04a2870a9d8518ea81854de7f528a949af9bb24c8b9847247f8c343dd1fa04c7871a177220c7f4768198dfd7324cafe7ca6bda0ca82ad2c3e48f94e585d77d2af51560ebb21bd72c459dd6d978948650c4e1502009333710822a6c64f7bd1c5b34d98dfcbb4a6912b6df5a762fc9d68c83453d10147b21133fa5e4408e7389642eaec42ea31d5333baa59134bfb349a4f1dfc86533c936d304472603b1c36b4cc9de2d07d2593d943a36a69e911a859ff5f61aa6cde61e58ba5a5734ca736b1cefb0f211b0c9ce3f1fdbbf390bc6328576d35a5b499b82aa4724a25c404c30db876b38d4a634af3b4fdc058f967ff95f5ebfb10d11ae0ad295ee2d027b16639179582ad71a618890b4819f279b0c8234940047438ce75dd78aff20aee399ab47adbfeda2751900473512b5898036740c00de4385221024c110a1a4e9e09cb1040ae8acbd2024bf66b9d6713eafc577ef8aa3cd5b3bef06980e1ae139dae91cd07a1a8db1814a6ef82a16f9cd8e8135e61a950f4e3f4eac656bb3fe29394695b3e59eb8040253b5026f1a75be873153f898fe2ee596f3bd3011b4233e657cc4b631bd56410a063b8e702a0e9a009f7c2eec2455a9a9a6e2ffe7657a02c65350e047bc8fed002ca9a3158eebe76391568efe50aa20de31c3dcd50d28fcc492e23a0fe68a924e8da64a468d363017d08923b6c955d49e5b07cec3f658b4c80321ca718270b75bf1db8aeb7014fa8424bef2fdd97f4d52eb57de996630b3386cb69a56d768e58f20ef6bec80afcf12549d05b9c6501160aa5a123fa6d8807e9648b2a42e9ba352e18bf531022f36292acd63d4d9efaa3260b9749efe79a30049801845cf31790cfe5731a241bcb8316cf714345a85a02ed41b0c9cb53ba5284c06d61f0251ef253dfa2628847cdc92e3c221c3913979bed029e02215450d5d6981f41c0f238e05671ddca9129a2ab457d79167c534bf491a8bfb1964c06306669978233dd0dd1544675c0e343c2a0090dd6c0a409df9377be86267ebd3308d0cf76c1bd68065bb9b81ad40328b65dc557dba93489db0efbbe81ff6f2a7fa592343d7ee205aac603512d72654ae62b16f5f84ea265c6bdba23438acc1634cd27324c28364873c6ddbc3e3a7e2cda9e8a72ad2f72201b262f874b8739f30ab60c34334c2e92f9d48533cd8ad2312c3e7c386aaa283b50dec844fa432d636a16bdd483593f978555b6524be1f60a337188b1d16d3939f05e10f6e06d1ac9cb55b87dacddeda8dee0ddb249ee4e1a88de2c9941d7298e821aa6179e5376a8b70988aa1058bd594f0c57ce37fe6ee4a4eac4396c767dbb7eaad42174a4e572a588aae47e48232b6e1ed0f0a690ccfb001e0c2c91d9aa435e7537af03cfdbda2f79aba7173ac391a4bec5d40643ecb042ee50ed526f33b89a004d0adc32ce21ad52e78c9b9ef32e9b52a2e2e79642b6b5d23ef63eb5be7dd9d290ef6e7c30fbb78b0aef7be34644aa80f497baf67380f17022d1b72b8f1566728fa72b1ab8cad6a8625a38a641866ab0378d00f2d3718e3ea8fa4c5f4a11e856b5dca28caa117331aa57426659664466e81d59f9f73ae4a43dfa7ecf53f5d7f58fea65509962159d2f6129921266d01b82d3169a533f7d375e3cbeda5133ade59a7ac3e50b2f56618df26eb7e10a96549448d7528be1e06e864b9d2ea65de28d51e87ed883fb8e253295824669b3ff9898e90c90e5d496b042918a3ae7c71e8342cdd6a97839553ea9c4f4dc0105845e1d3e36f4158a18b32fc9166d8a11aa3dd9957bb67c7b2434700b46e74b71bd2b7da2d6fa7f74dedd8a3cc25501c01e33a2d9ceadf523739d11d2e8d69d8b127746c17cf2a82751960e770e7fe354f2fb2b055ffe66e4dbef0bb66b489bb41cd81514999b1404398309025b5ca342c10ade9290066611c590ca103eabba8f44a44516ad5237addf1b26695969c60bf0d93a1c1f74674cb928d98ae38e7e6f228273322896a786bac4c3166925c0231aecda0c4eb6eef82f1dc680fa4f5be62ee91c11bbf6d82165268b840b1f262a97bc1aedbe5c51a6bff5fd9cd39ce786c25eac1fa7e14e0056a6dc4ccfc46c850fdd893aeec353cab437fb291fc585c3a5499fc6acf47d9627cc31db17a407c4ebb7a16e408a69f6d45a4bd02f77cb1f103083a11b8eeb65210d28b9833c9c5ca3d10012541fe89d78e37c0c93123c1bcbb9e439744f1c0ffaf01d62930c7edec0c001a1ba0264311a59e848db233d2c102c3dea578383c91e0bac50b78243adeafb42a6c2c0615441243d1f783962d2863dfd5e35eac75302c6521e713c6f5c5ae92f8c0ee8646985e8c6fafab321a1a635aeef8fd33b2021a68b2640a9765cc92044ec0ec8f203410e3255c32f1e0bf8c9df28d5db63a32322c402b647dd418e271f2133007e941b0afbca621b9c93e650ea849871e56e6fc1993e3296288d42641ad62c2d8eae6c758fd377f741bbf7616dad582514e4701987235622dca26e7db4755a8e86b4cdc46adb454091f6c481e4ed856396a7cc80fa7c916c6e236aba98893ec21b49a77e097c8a8601d6b628ccdfb0cbdf2add9e7f8464d15182dfd1238c596690cf92090821984615de44cc91fe6abc42d04bd892e550f01b433627e1e92acaabd9160be354feff426008f3e0c403b3864a6fb5b119d6574fd6f645503a338cb0d89bed07913f201c2e6b2525cb1c500dfbe1bc768c756563c0a8a00af9f41b4450ac32f160d947077c03d6cd6e34f04e672a634fd7aeb8dba2c5ce5ea2fd04dac3bf543d4e4dd298eb3b9f6447be42cc1ea230a965f2b02bcfb636d7cfbec7e8c45df747b40d5144ee9ad576c248960b74f1ab0fc1d1e9d8da226002caa9d2f2b4f062bd2cb851a018aa1f71684488811c91390f75dcc4774472e07c3e5eb48d382f4cea22af421edbd1d3e0c43288c187f97114ec73ee6b81301e80a53dfb1ca0630c7b3082a125cabaa94150a3254119a2d9bcb027b63a22d290dc69d80525802427ccd0b30d6947ccf61f8816cc847415e9634b78ba77abd2edcc26ad713c79eb357b8db0d53de57150d7e4fe0d1019db16a528d779988ed96bfc563eadd5d0409be3b21c973816403006f1c965586d6ae80ed2d462013e3eb1d9630c3966459cf1b20856d1dc7cd21a29392943d1f13dd3ecd3e002665c7b45efe786a2822c88ad52dae0039f6b7f75cb157e472147cc70db969ae92c4c27ae9c5e3e579e076c4542b458aae574c0e9493138edbad3bf3567a56564c79fcc428b31b3e73e58e0400e1f1146632b4edb3ff6f985f3275e97fd8ac033bcb9c1a828fc57dfd7b36d341195ba448cf171c22be120ce8ea5532f29b14ba4904ca045f238ca8fee896b87f992b453c759c244898a6f15d1e0055158b35855d6bb00b273515c96075d83b222a08fc2a6d6b8c8c54d050a516a1da5270b86b5f4773b6438e0be70a6a21e492949ad3fa00addc58bc3a30aa1a5e4a1011447538e13e8e19f6140be40f9c3c379f8ad194738a9d13968c9953725f2cb63782a9ce81371a1235d83cd6ab6eca7a1380fee111295624ab6d948865cd08aeaa19110a6e86e296120182c888c216c1b72363c721b38ff5c38627313cd0675f32b2b5d4f2546e0e5634e5a2ecbea975541c072fea4fd0eda67f5d37408fcf3197f59b1553c947e0c91b6e4c208a0affb212f302b526a2741bff3b80b633cb8ca089cdb3da0cf476335e24ae6c4fc1c599ae2d26ca608cf2ebaecbf5e9e3e0d817175398cf46fd375ca510b117355731d198bf85712417cfde36147e20c8987dc24633aa7a9eeb8a0c97383b6b6353aa2177b006f29ac974bc3c1e04a20a7ae369bf77d3223d44d90adca635ae023d9753f4099094eb2d474d6bf26db8d00e73d62a27fa114a938b1f1d628829399e622db6d10da13fc8b1596897a3aa42dd93d02e49078dee5d081302721a2431fd72786610645fbd241ba7de158cc08a6eac1e73e7e1df512cb7ae32e0d5e711e22ffbabcf7d178ec8eb0073751242cd492789a208724f9a8702b756b4a0b902d501802e154010d93c8b2ccfbe1c7736f76ad963b5a124f2f750f815f462e42c5f50cd96ea9594c70961f39bf891a8eaffdfd65df556a880030a3718aa05aeb60784ac8c5664e980b6d71d7f2b5b1d14e9ed4739d079216d33963d06dd7060c95605e2b86295582bcb53712260611eda3efbf69e4ef3d8e00f5dd288968b418cd33c3ac1151029f1d03fb82d9f8bf3648573a93578aa150220c7bd46dc3e9b28068f7b5078bda4f94e02ba47eec1e3db46bc29a6558720faed3dc8e7b771b4c477676c0c9184116ccd043f1957eb37670a3e3e98ed7240f1fe25b9142f0cd689af2dd79e6a4eb771d3ad0f4be1f1382f5761afb34954be0fdce859744df7479f354782ad0b01df31ea65f18494bb2b5cb88d46a07013e27b0eef70b0181b4f2d911f35e27a87d1d39994af6c79325b15b22ac9076a99f45e1ca1c66f995e385b4c1bbae5c1c6d58069a20fac973c0f83cfa0018f40cc3cdf8f65225ad6a94853eda5d85de8a83360e0f7daecf7c28ece9657b6e1f9960227eea54e18d9e5c93afc2456f2f514329a88fbd7d39fad211d8fb8b0a59dde8d5dc1c81052aaf8013b0100fd4df2f11b57e917d00a99e310984329b682358c26aa913631b04fcc397b85a09516e62936be89b18b39ed4ea36939139220c8871536e45679d9d247b825106ee6f4daa3cbf8f233d207a1d522b5f9df0a285eb9a2284592af763a53c85f28d1b790d547222cac036b1cbf5fd4a70cf3e742ff0915a939519d2e90d7af515731d192dffd83833d8b1e214ed60264f9b9f015b45fb5e04afc09aadbbab62524f7fda100ad35252f31b5be5721f4174897ef4a84a3cbf6fff9bc9223e6250017890165413f81390a5ff69ae128f2e682f7aa8878bd9f12e0b17e8d7142440cb950a588a99bafe7547cab5ef4d344f92e40eb789796795d768c1643ccb65a7191b4b3af41aa075997f09ab1980a3179d4da78c2e914a1ff48f34e5d3c2ab157281ef1841052d0b45a228c3cd6b5028efd2d190d76205e1fdf4cec83c9868fe504f429af1e7c5423267c48a7b5bc005f30a1980147a3fae5c100b95c7cb23d43af9f21d87311d9cc826598993e077015f59ebc476383bb7a78787d915c97039ab188a2a618f7a8d7f64542ba787e9dd7d48c4c87d2aaea068c1b00c9711b2812901673c11418096d0a850fb36b0acece56d311689dfeceb0835009adc427f6d2d6b05ed26f5a43b6478bc72c1f914a2202dbd393cb69b1a1e78162e55ca4b3030ac0298131a7a0d934c032cc9dfc5afa600c59b064d2d9013f15d1184278a8ccb5ad9d7563e666fe5a8c173cec34467ef9cf6d6671208ff714741fee7c8d1d565edf82570dffde4f3f584024142056d8548ad55df83d1babed06141114c95ac88dbea0ce35d950f16d8a732a1ea7d22dfaa75a3e0410c546523277261116a64bcbb2be83e55e040f6c8c79f911b301a8718cc4b19a81d5f0cb6312d87c5b4b079e23a61d247541cfc2c41a37f52b2c6e43a3db5dc47892d0e1feabcc5c808f2391791e45fb065159f99c1d8dd2f69baaf75267eb89dd460f1b6c0badb96cbbc8291cefa370fa7ad6997a4ca2b1fe968216032f02f29837d40215fa219c09161df074e1de8e37056e28c86d1f992a651e271dfc4b0592ad481c613fd00c3eea4b6deabb9f5aa63a4830ed49ab93624fa7b208966eccb1f293f4b9a46411f37d7928e4478dde2f608d3851a8efa68e9d45402bc5124fde4ddc0f83ef82b31019d0aacb4b5121bbc064c95c5292da97981f58f051df9502054bf728e9d4fb7e04787a0890922b30a3f66a760e3d3763855e82be017fa603630a33115a02f02386982001def905784f6ba307a598c6dbaf2946fe9e978acbaf3e4ba50ab49ae8e9582520fc2eb6790deafc77e04a8ee75da92d16f0d249403112c74bc09102b573e110ccb4d8461d249bfe2e85fc9770d606be6fbfd5ec4c30ac306d46412f736e5b696ccc9fbe4adea730955c55ea5c63678271d34b7bd6f6340e72626d290820eeb96a0d2d25ea81361a122ffe8e954cf4ff84f4dafcc5c9d3e7c2ddbdf95ed2c0862d3f2783e4566f450ec49e8b01d9d7bf11e92a7903f2b045c57ed8a65ccbfc5b1d2a38e020a57b38f2e4deea8a52354a7e7be4f977b8f5afe30f6738e955c8bda295064586b6827b245766b217fe39263572b0850965c7ae845611b8efb64c36244a39b9fed0ab970ee5ddeb8f2608dd9c963524a14050c9101d7f2d5537b24d0b0f7a45703c1e131656ec9edc12cdf71dae1cde2790b888ef2a589f03201f8bbfad71f0c4430477a6713ad2e50aaefa1f840cbb839e277389454517e0b9bd76a8ecc5c2e22b854c25ff708f9256d3700adeaec49eb2c4134638ee9bd649b4982f931ec3b23cc819fbc835ddcb3d65e04585aa005e13b7ef8fcafa36cc1a2c79ba6c26fc1dc0f6668f9432c578088cd33a41a778ac0b298fcac212edab724c9fb33d827409fd36bc4b2b0e4e81006fd050d94d3271e0"));
}

fn void shake_known_vectors_short()
{
	test::eq(x"c7211512340734235bb8d3c4651495aa", shake::xof(128, 16, x"d9e8"));
	test::eq(x"9dfe4efaa2c43081702cbfe8636859ce", shake::xof(128, 16, x"fc948f094aa4b4e035"));
	test::eq(x"c3ffe9ea9fa6c9cf59ad26f44ea0b82a", shake::xof(128, 16, x"b0438cd9e8853e976cfc13abbbb62fb8b5a50d59"));

	test::eq(x"8e2df9d379bb034aee064e965f960ebb418a9bb535025fb96427f678cf207877", shake::xof(256, 32, x"0dc1"));
	test::eq(x"54f5dddb85f62dba7dc4727d502bdee959fb665bd482bd0ce31cbdd1a042e4b5", shake::xof(256, 32, x"587cb398fe82ffda"));
	test::eq(x"731f8099a9fa3b8651f1be817540bba7453443ab48bc5e5c5281a2ed448ee679", shake::xof(256, 32, x"bfe5352ef826e9e6906175d747e23ae53dddf7ebb517a50b18e39f433d500641e7a16479"));
}

fn void shake_known_vectors_variable_xof()
{
	test::eq(x"2ece1768a6ef6568a2dff699613f49d0", shake::xof(128, 16, x"9a335790abf769877c9e6cd3d5199e8c"));
	test::eq(x"25904657e9903ce960b56bcc42a4e9ff7b33", shake::xof(128, 18, x"ca12721a7a44544d9518aa0d4e407529"));
	test::eq(x"3b37b980afb04ada89695c70c27eb887a913a502ed", shake::xof(128, 21, x"81c8bfe6fc0b1e92ddfad4215752bdd2"));
	test::eq(x"b824c8f435b8f86863d40522bc5875be67bab4f798794c7d", shake::xof(128, 24, x"382ce6a97be09193404b5f3865e6baeb"));
	test::eq(x"6136ccea5eb15b2229d6fc169db69d229fd0fe7a02ed6d87ea58", shake::xof(128, 26, x"d87f23db7553ebfceaaee817a49b0f1c"));
	test::eq(x"4abd4c46f3d06e4fd8e0e7b0a98496159350ce8af7ea331772895d71ecf8af63", shake::xof(128, 32, x"e01cbb1ab95410653be263b1c63e9e53"));
	test::eq(x"2bf4b5d1027f64b9715d563ad08bb325c135192e4702189b3a42683bead14e69121038852796fba5eae3426d33", shake::xof(128, 45, x"0969c08355404ee5502d29aa38081d84"));

	test::eq(x"23ce", shake::xof(256, 2, x"c61a9188812ae73994bc0d6d4021e31bf124dc72669749111232da7ac29e61c4"));
	test::eq(x"ae53c844d511", shake::xof(256, 6, x"dca55c76165b528f2080566538adb1f0053b66f3cea80b82ea3bd8c278ebfef0"));
	test::eq(x"3389aea66244b91428", shake::xof(256, 9, x"3e20cf32669fa3fd6e94e519b52a1dba33cd1f3a6947975e9829e4db326d2a18"));
	test::eq(x"7314002948c057006d4fc21e3e19c258", shake::xof(256, 16, x"e3ef127eadfafaf40408cebb28705df30b68d99dfa1893507ef3062d85461715"));
	test::eq(x"e7708cdc22f03b0bfaca03e5d11d46cac118", shake::xof(256, 18, x"445b17ce13727ae842b877c4750611a9eb79823bc5752da0a5e9d4e27bd40b94"));
	test::eq(x"de489392796fd3b530c506e482936afcfe6b72dcf7e9def054953842ff19076908c8a1d6a4e7639e0fdbfa1b5201095051aac3e3997779e588377e", shake::xof(256, 59, x"7d9312ffe94845ac51056c63eb3bff4a94626aafb7470ff86fa88fd8f0fe45c9"));
	test::eq(x"e7708cdc22f03b0bfaca03e5d11d46cac118fded60b64bf4acffb35b0b474fbe85d270e625b95d54157d6597eb4fbdfa482e636d4a44c9de13c71387654c1a254a85063dd7720ffd5c6fc50ab97914c67ce6f0da5ae14ec0f2c5cdad79c4d85415279d21e236519dc1422c5b6dd156ffe432c14f40eb458f21e20527b23c03e299736adc12620303716933509e0f8b8a8cef58a75810406b6dc47d65ae5d89f0ebbc72d8b1315f6a4a272b0da9fa19d9fa69aba98c30621cd63a4ac0b041a9439f986b728110f44817b157de7fcebf60d7a885f1c77211e5506da6d2a73806a53f33944fcbeecc9022b5f224e7dec29fb67234ec71bf69485245", shake::xof(256, 250, x"445b17ce13727ae842b877c4750611a9eb79823bc5752da0a5e9d4e27bd40b94"));
}

fn void shake_empty()
{
	test::eq(shake::xof(128, 2, ""), x"7f9c");
	test::eq(shake::xof(128, 8, ""), x"7f9c2ba4e88f827d");
	test::eq(shake::xof(128, 16, ""), x"7f9c2ba4e88f827d616045507605853e");
	test::eq(shake::xof(128, 32, ""), x"7f9c2ba4e88f827d616045507605853ed73b8093f6efbc88eb1a6eacfa66ef26");
	test::eq(shake::xof(128, 64, ""), x"7f9c2ba4e88f827d616045507605853ed73b8093f6efbc88eb1a6eacfa66ef263cb1eea988004b93103cfb0aeefd2a686e01fa4a58e8a3639ca8a1e3f9ae57e2");
	test::eq(shake::xof(128, 128, ""), x"7f9c2ba4e88f827d616045507605853ed73b8093f6efbc88eb1a6eacfa66ef263cb1eea988004b93103cfb0aeefd2a686e01fa4a58e8a3639ca8a1e3f9ae57e235b8cc873c23dc62b8d260169afa2f75ab916a58d974918835d25e6a435085b2badfd6dfaac359a5efbb7bcc4b59d538df9a04302e10c8bc1cbf1a0b3a5120ea");

	test::eq(shake::xof(256, 2, ""), x"46b9");
	test::eq(shake::xof(256, 8, ""), x"46b9dd2b0ba88d13");
	test::eq(shake::xof(256, 16, ""), x"46b9dd2b0ba88d13233b3feb743eeb24");
	test::eq(shake::xof(256, 32, ""), x"46b9dd2b0ba88d13233b3feb743eeb243fcd52ea62b81b82b50c27646ed5762f");
	test::eq(shake::xof(256, 64, ""), x"46b9dd2b0ba88d13233b3feb743eeb243fcd52ea62b81b82b50c27646ed5762fd75dc4ddd8c0f200cb05019d67b592f6fc821c49479ab48640292eacb3b7c4be");
	test::eq(shake::xof(256, 128, ""), x"46b9dd2b0ba88d13233b3feb743eeb243fcd52ea62b81b82b50c27646ed5762fd75dc4ddd8c0f200cb05019d67b592f6fc821c49479ab48640292eacb3b7c4be141e96616fb13957692cc7edd0b45ae3dc07223c8e92937bef84bc0eab862853349ec75546f58fb7c2775c38462c5010d846c185c15111e595522a6bcd16cf86");
}

fn void shake_simple()
{
	String[][] expected = {
		{
			x"d6b9bdbda14c3858c36d5af417fd083b",
			x"d6b9bdbda14c3858c36d5af417fd083bfc8b19b0bf535831a09a057d9b6e6e423b0b04230cd9427a652bbd85d28e72eb176a3fa9d0348da2d823a9befa9ef95cc7d35fb8d965bd2f55ab19804500c65f100591b02b38af5e963cf8efafcd8c1701ed9806291e54a02055184a8a0042f79a7bfa8f737909e41e3b1a6fcdff2687ed16a427f3b6bfaa811d5065d793d0c87ab31741a2186536ae306c81b952e89ab6feeb45a6b6cd90a3b83aee76ec2f11c642ae6d82ca9311b6d2f4b27b076b91d58354b6fff59df9fd5e60ff7ba978e3b177268eb633b5a2a8260304ad9715e99ed52b6019e6155cbaa6036f47790f4f3215ffd055d87b585aedb67d264e84fd",
			x"de46e887727353da377b63ed4e7b4725",
			x"de46e887727353da377b63ed4e7b4725d1819442ae7284f691d413e81de03e2acc55c6e73d857e5396b3df15def4c904ae57010a568068568175c40aaece6c68bf21ba39ed0d984154d37d009c36618a575729587864097f34242d71dfdca57c1742aa2ee3b8a3c9c5b41a81e25acd14158c89bb6171be2b3907cf8045ee451528dbf213ba111610f58c93cea98f23ba990624fe89af382057527a1c88c59b003a0cf1b90d384be746ba577dcc93d488c0e6ce987ac46e475bc20fc4a134efe122fba709ce5c83eecf4aacd9c6b0ef806f6aba8cbffed36b1d1be82d07b6553bc0f5b6afad0dcc9aeb381ea9171b469f5c16245c121b80cd7aa27724447e8ee1",
		},
		{
			x"961c919c0854576e561320e81514bf37",
			x"961c919c0854576e561320e81514bf3724197d0715e16a364520384ee997f6ef3be7ad1ab687d31ebd7e6604ef2c7652932e4206113d263514e72f31f5e1df87c5f54fc43e8f857fc4a52bbb565bd6d45869df9259c09774728394e3e0c3b326410085c356e5b173d570087945b0f068e4c63a5b191fef22d93b9fd4211328d70e514fec92b1b48643495918b641eab05460d0798cbe42fda47a2375f1065d037ebc76bdceff29efa43c82793c9ff41e19834717532faa42bcc91287bbddd88efe22fb471db95463dd3d6d3dfc5079042181bc405be83321c0a51431588b98019506a1e2def66bfe45a49c2d662b547becdcecb7e87a51e1aca962f08e3a4808",
			x"b7b78b04a3dd30a265c8886c33fda947",
			x"b7b78b04a3dd30a265c8886c33fda94799853de5d3d10541fd4e9f4613701c61075249bed16b0781108fcfe086dbf38a7fb8300807cea85cc649328d07d4ff2b5e8908563ff0fdcc06a8092fbfe772f80e49f87a103b2aee12990ccb4798e9ec03aa4818a4bf5abda084e1a5fe687c2cfef4406846fe47a0d07bf45055a2699c37d6b6d9cd6c4ff0a675191553f1e30bf471eba3c78fa7a52bd33c48912c0d0c6f1145d3117a472fdcd9afbb866ba1bef4f5944c09b036b3adadc317cf96c1493b8f61cd4d1dea113d9ebf8a709f0f3bc847aabe02b068e4756752696ca0e1ca89360673c323e9b3994843b8b6f73391afe5f96d8f3914e95c74a6cb0a3052a5",
		},
		{
			x"5b3b6a587417f8fa192aba21c16b7b7a",
			x"5b3b6a587417f8fa192aba21c16b7b7a6375aac5f04e950f82bc4773a83e99d977258850244748065ffeb53dee9220e9bc39ee319f49570acc91d29dbd9e500078f6923a1e8402d1cbec50ce2cdf53dca888a35c158ca5bd456aa96762156f90d1c8d093917fe20a727548da6cfcaafcbdf078440cbace2f173b16d7aaf38979b919f6ced2d7a5a1b078e0218023f23cdeae774460647c650c964c7fb49d75477bf57d2fe0064d131cb6a31783b71bb1d351f4935ac8061551ffc3c9c5a3c8de416fa4f4430ffc8ca1fe993227114b6eab1bc1abc419844a120ed3b3b139721f6f112c0286e24331ce494b881c5c7a51d17d41477071d72f7f4fad674493ba29",
			x"fa8775b64bf3aaf10d7f473c460f4d23",
			x"fa8775b64bf3aaf10d7f473c460f4d2361f56ff34ae7267a79409ff09d4f762020a9fddc23dc80f727d17c522f398ce574589f708cb3db1498ae53258c58fa98027e0f5605a408ce8a8766d2c956d51e22400295e87ad531422cd398038322c06bb3acd65d3d835b458615dc7dbe99ca5e37022cfa65fb1ec86d14bbaae0ea08ce386ce2e28d408266c28c7a2ed60185028997af6135fd00827ed4446fd4bef4b49df0da96630fac3f3e7a1603d97992e3b2ae4d5c1213d4e1262a1f104cafe7ad7807af894564f65c03fb164932cb1a3906ea93e889a230d4926e3d4c443414048176a9f77c31f3f5232acfe15824af18a88cdad5a3a6091165864fdd6cc769",
		},
		{
			x"f4202e3c5852f9182a0430fd8144f0a7",
			x"f4202e3c5852f9182a0430fd8144f0a74b95e7417ecae17db0f8cfeed0e3e66eb5585ec6f86021cacf272c798bcf97d368b886b18fec3a571f096086a523717a3732d50db2b0b7998b4117ae66a761ccf1847a1616f4c07d5178d0d965f9feba351420f8bfb6f5ab9a0cb102568eabf3dfa4e22279f8082dce8143eb78235a1a54914ab71abb07f2f3648468370b9fbb071e074f1c030a4030225f40c39480339f3dc71d0f04f71326de1381674cc89e259e219927fae8ea2799a03da862a55afafe670957a2af3318d919d0a3358f3b891236d6a8e8d19999d1076b529968faefbd880d77bb300829dca87e9c8e4c28e0800ff37490a5bd8c36c0b0bdb2701a",
			x"2f671343d9b2e1604dc9dcf0753e5fe1",
			x"2f671343d9b2e1604dc9dcf0753e5fe15c7c64a0d283cbbf722d411a0e36f6ca1d01d1369a23539cd80f7c054b6e5daf9c962cad5b8ed5bd11998b40d5734442bed798f6e5c915bd8bb07e0188d0a55c1290074f1c287af06352299184492cbdec9acba737ee292e5adaa445547355e72a03a3bac3aac770fe5d6b66600ff15d37d5b4789994ea2aeb097f550aa5e88e4d8ff0ba07b88c1c88573063f5d96df820abc2abd177ab037f351c375e553af917132cf2f563c79a619e1bb76e8e2266b0c5617d695f2c496a25f4073b6840c1833757ebb386f16757a8e16a21e9355e9b248f3b33be672da700266be99b8f8725e8ab06075f0219e655ebc188976364",
		},
		{
			x"10cb31367df9831df09c538011c620fe",
			x"10cb31367df9831df09c538011c620fe820ed6dbaf2302b75f8922abfa2f239f3c81deda2fad54db2f191485a01aaba679d9ad2db16a9983c9919fd1ec5e1800d0f66d08d19d2a8cbd000df570917f2a9f56cb69f6e810e34b0d73a9461cb2d778cab569b49bd20f4f135ab0384b4a27315bf59c3d70b75651c8a37d9324a147a7678fe22f2a791e4dd280b6b763ca3712b40fe25502ab058fb7fb52b018f68c6b01d22ae583a7ffae9a58bc5653350e89497d9ecd69b41f326cc9e6cf1d0658c05242935f477b6e0b2c1ccd3b544ea38c672d914ba1fd253328092cb37ed6f6324a188e0c9bec758e32e0e0dc169fd5c587d288e792e7c10d2b1e022a022b72",
			x"d438d1a7d4363e18665acd10151bc2ae",
			x"d438d1a7d4363e18665acd10151bc2aee1834a9fa463002e81efc3eb5d35553fd12f957c75b21af20fc2f6dd307a6c8704a4326d20d9068fd678555eb436f86e0359be3522be5cd4a25e138a73ac6908ea7b55de8633f4caf439f5b0b69db00403e4bd6726cdc41dbf0e28398f5d90732338a1034efbc134ec38b3546e839c90bdf7bb2b41352c6ca0b84a2487eb03962f5ba64e0ddee8ad568ed79b0365f14c3a655629e5db611290a74e716c727f2b4fc4d344a07ef05875c028902ec1482f45a18d236d875062e683940ae376a252244607cd99205a8b48259c5b80bbca071d38afa14b793df45112fe29b65f68e7baf039aaab9fbbfff2aac6e1ad0026fc",
		},
	};

	foreach (i, v : tests_common::SIMPLE_VECTORS)
	{
		test::@check(shake::xof(128, 16, v)[..]  == expected[i][0], `128(16): Failed on vector "%s".`, v);
		test::@check(shake::xof(128, 256, v)[..] == expected[i][1], `128(256): Failed on vector "%s".`, v);
		test::@check(shake::xof(256, 16, v)[..]  == expected[i][2], `256(16): Failed on vector "%s".`, v);
		test::@check(shake::xof(256, 256, v)[..] == expected[i][3], `256(256): Failed on vector "%s".`, v);
	}
}

fn void shake_interval()
{
	char[257] x = { [0..256] = 'a' };

	String[][] expected = {
		{
			x"85c8de88d28866bf0868090b3961162b",
			x"85c8de88d28866bf0868090b3961162bf82392f690d9e4730910f4af7c6ab3ee4354b49ca729eb356ee3f5b0fbd29b66769383e5e401b1f85e044c92bb5231aa4dee1799af7a7cee213a23adcd03c4806c9a8b0d8a2eead8ea7a6134c13e523ccf93ad39d227d3e7d022d9654f3b49413788758a6417e42d41957cb30cf04da37f26897c2cf2f80055846293fde02331cf4a269aaf2d47eb27aba0faba4a678ec002bc0d3064ead0a3f2e0d8a7fa404af54ebf4f5b183562a8dad73b9a55bf1c066e0007e7ab8a8988a5a1d31729c2c6aeb06f5a5c1bc996f84d6dd227b989862db670465c02da0501cd1b4a324a90fa4ce7316665fb68d4c495d792782cb45c",
			x"867e2cb04f5a04dcbd592501a5e8fe9c",
			x"867e2cb04f5a04dcbd592501a5e8fe9ceaafca50255626ca736c138042530ba436b7b1ec0e06a279bc790733bb0aee6fa802683c7b355063c434e91189b0c651d092b01e55ce4d610b54a5466d02f88fc378096fb0dad0254857fe1e6381abc04e07e33d916935935636004896c5b1253464f1cb5ea73b007bc5028bbbea13ebc28668dbfc26b1240ce4239f8d50627ddaa01641dfeaa9d2fef03dd025e0b82cf071fb9ca3232c742d836b3cbcc8c3cba5b058b76795c177012314196dc822768991c0f16f8a655a731fd37ec92460d61ea722e2723c8681235c4cfa70fdddfeefac1a892d652cfbaa02b138e3b2d050d550f0c977c024bc2aab0c3456a6afef",
		},
		{
			x"c5756758b525c25a7ded2d3d78ff3e7a",
			x"c5756758b525c25a7ded2d3d78ff3e7af54e151d2911b0a9d3470083cbdc41484694ef82bcdf9da94f07c1971d76cc9a79060c248d179da8c17af59c5923cc5d4392ba58021e4b1e7f3e117b36157f67deb0f72a02938579967a163f4968eabbe8263a96a0bb80f7e2736d9d59c3b21321c399be51c032cf91346df5fa90c29cba2794415fdc7eeaa6d2d8a950623e5999dd44615e21b59347a721ae897be4ae3efb29c0f42358bb17aeb15a8deb3248074fb0dceb9e1e96da4a89144ac9baf9ed69728dc53a5a5b287b6e6bc3226dadfadcf7271e1141b97167a916eb931c02e58aa7eeaf67a83d1d01e2016f0d7ff49b01d2cbbe9c7626afbd9f797ca5dc8c",
			x"df3b2b490c91687b6d7e62b5794dffaf",
			x"df3b2b490c91687b6d7e62b5794dffaff7836cb4bdcd3d995a0aaf83d4e22b408c8f884d941e2a46813c18e5379167ae9ed4140c3fb3ec4c65c3490582dc69b4e581ff9c0ef8bcaaf5dbe25ef1d74fa842aa5c128a80a2c6f5bb54c4927f5ef69d066b4f68ac6460d152cbd9f2c31d4112424fd40f7a30630a072fe3f7ac293ff61dee25f3cf571e6f359d6560482614d972a86d300d89a77412e14d513bb4e34fae4eb67e001c60c4dac6ea44bf3fb38d195bda909f765a4843e8191a62ba3915adfd737082f5505fa53254baa49cb0a20d8f88bc44944bb1b713fcd32d077735228a497611830f8d150f2a306a80ba86010244b8677a3b78611c65b08fde58",
		},
		{
			x"81e1c5431818c6b53881d11d892d50cb",
			x"81e1c5431818c6b53881d11d892d50cb904dc8c82eb4ec2e24fd03fa795e383b65812ed8735823cd16a1e04330fec1beba32e1acc94b9b06905d20cc1f2545647a0634a6dc06bebf7f625edb2b7fb224d653a9c050b72ae242e9b0215a03b19d7d9a15bbec659ae96b19ee2203fb33c7160d6099a781c45c5645c3df1746d0f8dc034a51179dee3e7ebe022f9ef06fc51ef55b392db834ff85a64b6b6aea62cd5bcf7e8d79a53364775e78b4f224d384ca36398b2e4b52d1bc93f8fda0ef859abef29de5a8936f506303687146addf05b117dbe04a684f5e071289055a1be549bf612f5e09f0997a90d3068fc3c1b78076b495744cb8f64a05e2e217e2843c59",
			x"e478ad702bc6ca248f8a07ab7937c6d7",
			x"e478ad702bc6ca248f8a07ab7937c6d767287c83d32c363e4c4eac48262e66f6c9922ea02d907a02f873c4d48cb8b66536e4ef538d33865f5bbabb0c9a40c1615dee9e15523613829e6d1977166497ed580a325b4a3310df924452ce392898089f0503cf2a9df5dae394c2a5a165f069be0936b51170b06b6d91d2910a4f9c28ed37c952b0cf156b7988580fe8af5016d9fd5ffdd7dbfd62e5b000c997dccf865146857e60478cb7f8de0c6e185406641fb01b374db94318a11f4137c261fd08d407047592036506347517a0dfa96658f0880bebdc87e7a5a615182567f939e7204c1f3c0d669dccd6d4240e8f00d42bb9a16ce26147c9075aaa24f2eca1e671",
		},
		{
			x"1836796fb8a6ca6a172eef75e7c24a95",
			x"1836796fb8a6ca6a172eef75e7c24a95e0d3c107d6e90c5c821b77629a8357464f5be88bed8a2a65e4852005c44aae66812162b3e43e74f974a177d269ae7c7ac248fe7410a493d0c670f55304084b4b977575ab4468ce612a2e0854a3ad01bc610d8ac159f16cc43ee496b8638c4fa2e0cca2187beca7b4f60c67a72228aa9b88bb33513ce97fe23a11da7613b612dfc7d98627fcedc971abb25cb639873bbb22734bb0820fdbd70b74d7d8d6e22a495e1bf9d36242814236de4f4019cf2405047992368499b0afb9bffefa1d48523d15be5a5e959f2b78266dd21410979fb1c90137e528fc1207fa03a9bc3b8e6e93f8d746362091ef46bf03cf4fae09b766",
			x"80cad9b26e7391c85da5276fcfa590be",
			x"80cad9b26e7391c85da5276fcfa590be59271771664a12fc13fdfd9bf0fd9a6ef111ce51c69c103839ad1e31bf3740d3480284430cc260da8a93c136f96d7820bdf0d832645e99d67f4beec37897eb6fd043794b89472a7db94e0f918f1078971b1a3a0426129565f9d11f68e6cae962d806759d7a1a248131dfb24a5520e77af09f03ed1c062368da0fb581f883ad81e4a2da51314a309e51ae8ed60044396816868d9372d13045929a74f2025ff3f64bfa2232fa825b4f70f781480c416e306eb8b8b5eb03699353499402dcb3dd60754bb0277c9555b37cd0a8f021ea7e7fc288c55be64632e44b36ee1297b5cfc7f50253063c90fb21b5e0ab6c86745ecb",
		},
		{
			x"61803382dd6a0fda161539922e89fc29",
			x"61803382dd6a0fda161539922e89fc29213a1ad3108b5f797f8759b87cc3809d04b728a10008fd1b9f2fdb649b62932d47b35fc91bb1ba96c8b2ae7976b2fd92277c5a8c2a2557356b9de9ec2598b30731ba2b3bb5f8d447c9addaf8ae7e3b02a0cc52a9b1aad5033f91185cec32fcc666239bfdfb987e06bdc816b421dd30dee9a16ccebe3f2fcedabb69bbe53da4182bad54cb85a961dfedaa4d13a7671ba9fac445cc705b2d8878b7b51f7e0bff9c37568e4697055755533fadf2ef96809874a5896e710b0ddcb659bd04f01f8a37e460950a595e522181a764d128e232182fee5cd92b960e3504f2148790862da673ec5d926b34798a167ed062d24545e8",
			x"013c4d9eeb21ae8f6114dd600d3ffa7c",
			x"013c4d9eeb21ae8f6114dd600d3ffa7ccdc3003488971b09dbf9c695e9e0d422be3020517ef89a1c750af7710ad0fbfd21e3203d6beea30ce924e467d76b61456ce63657a7a09d899b2b0952875019646da59a1b9510b53941783451a9171eb4eba25ded1865c22272f357716a4d8ff2e39018a4ca7652f92dfa21b66c9646c2b1649784664ff29d390122db583235d737d5c03fd45565cc45df84eae2c52097ab0073d7c51e7900bd9186a75bda9e06e19a875a6370c96b0576351b6175e25da5eb7f368145dd9b6abf82dc7744828bd4928cb89b6d1085e78c322554c6e138e11eae6978a26f49f4776092353f758afb15312201ae454d7809cafdd1c430df",
		},
	};

	// 'a'-array of lengths [1, 65, 129, 193, 257]
	for (usz i = 1, usz j = 0; i <= 257; i += 64, ++j)
	{
		test::@check(shake::xof(128, 16, x[:i])[..]  == expected[j][0], "128(16): Failed on length %d.", i);
		test::@check(shake::xof(128, 256, x[:i])[..] == expected[j][1], "128(256): Failed on length %d.", i);
		test::@check(shake::xof(256, 16, x[:i])[..]  == expected[j][2], "256(16): Failed on length %d.", i);
		test::@check(shake::xof(256, 256, x[:i])[..] == expected[j][3], "256(256): Failed on length %d.", i);
	}
}

fn void shake_streamed()
{
	String s = tests_common::STREAM_VECTOR;

	Shake{128} s1; s1.init();
	Shake{128} s2; s2.init();
	Shake{256} s3; s3.init();
	Shake{256} s4; s4.init();

	s1.update(s[:20]); s1.update(s[20:10]); s1.update(s[30:1]); s1.update(s[31..]);
	s2.update(s[:20]); s2.update(s[20:10]); s2.update(s[30:1]); s2.update(s[31..]);
	s3.update(s[:20]); s3.update(s[20:10]); s3.update(s[30:1]); s3.update(s[31..]);
	s4.update(s[:20]); s4.update(s[20:10]); s4.update(s[30:1]); s4.update(s[31..]);

	char[16]  s1_hash; s1.final(s1_hash[..]);
	char[256] s2_hash; s2.final(s2_hash[..]);
	char[16]  s3_hash; s3.final(s3_hash[..]);
	char[256] s4_hash; s4.final(s4_hash[..]);

	test::eq(s1_hash, x"430bb212aeb2474a89340dc59b74c8b4");
	test::eq(s2_hash, x"430bb212aeb2474a89340dc59b74c8b456c50fb8934f76f5f346a94af9966b17d5209fe9f20775e0def92209b313bc3b782c039a51b90366d4e78004c92cde5840830afa38657745beef8293936f0044d8196fd38dba7863a2d50b62fa773fcd42cdec57aa6ca3cac479c90612ddb9864aabc4bfe01b6664adcb9d68e8d595f90d15652fd9bba3c4bde0e9cd719945d3daa11cec188fc029cdf8a8f718be1845fa505a52e6fcadeb82317675cb03621acfd74623e7beb669a74c748d724a72d50b3ce3bd761234015d66539c31638176ddd4c3808cdb8fc7291cc587543936d084385dd3164908f2c9f9961513311ac42fc20023d19180a7b587b1d81b696999");
	test::eq(s3_hash, x"6ca5084e8e796b725b7a0a546d596e84");
	test::eq(s4_hash, x"6ca5084e8e796b725b7a0a546d596e84a32a8c1decb0b104589465e6c550c6757d8df25b2dd483a51dbd66636ad4600eb533e721b018abf9a18b19f49540bf35c1727e0efa69abf2a6c50a7db3051c33de6ed98047d2f3e0e7a946e713130d51ddbe6f9387a55a8e97d73603cab8e8b1459bfa236b5e9e081d6643843da3d128113777d43bc1139a5ffb0612bde65d0b16816256fbf9d7f74c7c129ee6a415958f19d0c559cd5fa3ff5c0da7a42061b5a3cdd26ee382960b9fa7a67456c9a31a1c1ea91358655defa642f71d0c8afc1895f9cc83da28b16064b522ad28af4c9dc0f03044e6124b8170b587cc3f60425990e3d2f25338513594962ecbcc365f7b");
}

fn void shake_large() @if($feature(SLOW_TESTS)) => @pool()
{
	char[] bigboi = tests_common::get_bigboi();

	String[] expected = {
		x'9d222c79c4ff9d092cf6ca86143aa411',
		x'9d222c79c4ff9d092cf6ca86143aa411e369973808ef97093255826c5572ef58424c4b5c28475ffdcf981663867fec6321c1262e387bccf8ca676884c4a9d0c13bfa6869763d5ae4bbc9b3ccd09d1ca5ea7446538d69b3fb98c72b59a2b4817db5eadd9011f90fa71091931f8134f4f00b562e2fe105937270361c1909862ad45046e3932f5dd311ec72fec5f8fb8f60b45a3bee3f85bbf7fcedc6a555677648e0654b381941a86bd3e512657b0d57a7991fc4543f89d8290492222ce4a33e17602b3b99c009f7655f87535cdaa3716f58c47b8a157ad195f02809f27500b9254979311c6bb415968cd10431169a27d5a8d61e13a6b8b77af1f8b6dd2eefdea0',
		x'3578a7a4ca9137569cdf76ed617d31bb',
		x'3578a7a4ca9137569cdf76ed617d31bb994fca9c1bbf8b184013de8234dfd13a3fd124d4df76c0a539ee7dd2f6e1ec346124c815d9410e145eb561bcd97b18ab6ce8d5553e0eab3d1f7dfb8f9deefe16847e2192f6f61fb82fb90dde60b19063c56a4c55cdd7b672b75bf515adbfe204903c8c0036de54a2999a920de90f66d7ff6ec8e4c93d24ae346fdcb3a5a5bd5739ec15a6eddb5ce5b02da53039fac63e19555faa2eddc693b1f0c2a6fcbe7c0a0a091d0ee700d7322e4b0ff09590de166422f9ead5da4c993d605fe4d9c634843aa178b17672c6568c8a2e62abebea2c21c302bd366ad698959e1f6e434af155568b2734d8379fcd3ffe6489baffa6d7',
	};

	test::eq(shake::xof(128, 16,  bigboi[..])[..], expected[0]);
	test::eq(shake::xof(128, 256, bigboi[..])[..], expected[1]);
	test::eq(shake::xof(256, 16,  bigboi[..])[..], expected[2]);
	test::eq(shake::xof(256, 256, bigboi[..])[..], expected[3]);
}

fn void shake_successive_xof_operations_128()
{
	char[] expected = x"7f9c2ba4e88f827d616045507605853ed73b8093f6efbc88eb1a6eacfa66ef26";

	test::eq(shake::xof(128, 32, "")[..], expected[..]);

	// Now use the cryptographic XOF functionality to squeeze variable-length data out of SHAKE in .
	//   We "squeeze" 8 bytes at a time, and the resulting value of the XOF, when concatenated, will match the expected value.
	char[32] buf;
	Shake{128} k;
	k.init();
	k.update("");
	k.squeeze(buf[0:8]);
	k.squeeze(buf[8:8]);
	k.squeeze(buf[16:8]);
	k.squeeze(buf[24:8]);

	test::eq(buf[..], expected[..]);
}

fn void shake_successive_xof_operations_256()
{
	char[] expected = x"0fa0be094e07995121d257a79291cc44da77e520a8534a51aefcab18a1ffd4e87d2bccd77d10d998c0fd3d9bdf8f83bc66eab6";

	test::eq(shake::xof(256, 51, "sugar")[..], expected[..]);

	// This one shows the even though we squeeze at odd intervals, or beyond the length of the original expected value,
	//   the prefix will still match.
	char[128] buf;
	Shake{256} k;
	k.init();
	k.update("sugar");
	k.squeeze(buf[0:7]);
	k.squeeze(buf[7:13]);
	k.squeeze(buf[20:20]);
	k.squeeze(buf[40:1]);
	k.squeeze(buf[41:3]);
	k.squeeze(buf[44:9]);
	k.squeeze(buf[53:10]);
	k.squeeze(buf[63..]);

	test::eq(buf[:expected.len], expected[..]);
}
